//RB Master Clean *Dataflow Gen2//

//RBHist_Base
let
  Source = SharePoint.Files("https://hokkaidotracks.sharepoint.com/sites/digitaldevelopment", [ApiVersion = 15]),
  #"Filtered rows" = Table.SelectRows(Source, each ([Folder Path] = "https://hokkaidotracks.sharepoint.com/sites/digitaldevelopment/Shared Documents/Dashboard/All RB Raw Data/")),
  Navigation = #"Filtered rows"{[Name = "RoomBoss_2019 Jan 01- 2024 Dec 31.xlsx", #"Folder Path" = "https://hokkaidotracks.sharepoint.com/sites/digitaldevelopment/Shared Documents/Dashboard/All RB Raw Data/"]}[Content],
  #"Imported Excel workbook" = Excel.Workbook(Navigation, null, true),
  #"Navigation 1" = #"Imported Excel workbook"{[Item = "RoomBoss", Kind = "Sheet"]}[Data],
  #"Promoted headers" = Table.PromoteHeaders(#"Navigation 1", [PromoteAllScalars = true]),
  #"Changed column type" = Table.TransformColumnTypes(#"Promoted headers", {{"Package ID", Int64.Type}, {"Booking ID", Int64.Type}, {"Custom ID", type text}, {"Status", type text}, {"Order Type", type text}, {"Created (Japan Standard Time)", type datetime}, {"Modified (Japan Standard Time)", type datetime}, {"Finalized (Japan Standard Time)", type datetime}, {"Cancelled (Japan Standard Time)", type datetime}, {"Vendor Company", type text}, {"Buyer Company", type text}, {"Vendor", type text}, {"Lead Guest ID", type text}, {"Lead Guest Name", type text}, {"Lead Guest Additional Name", type text}, {"Lead Guest Email", type text}, {"Lead Guest Additional Email", type text}, {"Lead Guest Residency", type text}, {"Lead Guest Notes", type text}, {"Lead Guest Language", type text}, {"Lead Guest Gender", type text}, {"Lead Guest Date Of Birth", type date}, {"Lead Guest Height", Int64.Type}, {"Lead Guest Weight", Int64.Type}, {"Lead Guest Telephone", type text}, {"Lead Guest Fax", type text}, {"Lead Guest ZIP/Postal Code", type text}, {"Lead Guest Address 1", type text}, {"Lead Guest Address 2", type text}, {"Lead Guest City", type text}, {"Lead Guest State/Province/Region", type text}, {"Lead Guest Custom Id", type text}, {"Lead Guest External Id", type text}, {"Lead Guest Passport Number", type text}, {"Lead Guest ID Country", type text}, {"Lead Guest Emergency Contact Name", type text}, {"Lead Guest Emergency Contact Telephone", type text}, {"Lead Guest Note Dietary", type text}, {"Lead Guest Note Medical", type text}, {"Parent Category", type text}, {"Category", type text}, {"Product ID", type text}, {"Product", type text}, {"Code", type text}, {"Check In / Start", type date}, {"Check Out / End", type date}, {"Nights/Days", Int64.Type}, {"Item Rack Rate", Int64.Type}, {"Item Gross Price", Int64.Type}, {"Item Sell Price", Int64.Type}, {"Item Buy Price", Int64.Type}, {"Package Sell Price", Int64.Type}, {"Package Invoiced Amount", Int64.Type}, {"Difference", Int64.Type}, {"Package Received Amount", Int64.Type}, {"Balance", Int64.Type}, {"Vendor Contact Name", type text}, {"Vendor Contact Email", type text}, {"Agent Contact Name", type text}, {"Agent Contact Email", type text}, {"Message", type text}, {"Comment", type text}, {"Notes", type text}, {"Room/Resource", type text}, {"Option 1", type text}, {"STUDIO", type text}, {"BABY COT", type text}, {"FUTON (ADD GS ITEM)", type text}, {"ADULT / CHILD", type text}, {"DEPART FROM", type text}, {"DESTINATION", type text}, {"HOTEL NAME IN NISEKO", type text}, {"FLIGHT NUMBER", type text}, {"FLIGHT ARRIVAL TIME", type time}, {"DESCRIPTION", type text}, {"MASTER (2F)", type text}, {"MASTER (1F)", type text}, {"BEDROOM 3", type text}, {"BEDROOM 4", type text}, {"FUTON", type text}, {"COMPANY", type text}, {"PICK UP LOCATION", type text}, {"TIME", type time}, {"NAME", type text}, {"TOTAL PAX", Int64.Type}, {"FLIGHT", type text}, {"DESTINATION LOCATION", type text}, {"TYPE", type text}, {"VENDOR REFERENCE #", type text}, {"NOTES", type text}, {"BUNK ROOM", type text}, {"2F MASTER BEDROOM", type text}, {"2F BEDROOM 2", type text}, {"2F BEDROOM 3", type text}, {"BUNK ROLL OUT BED", type text}, {"NUMBER OF DAYS", type text}, {"Accommodation", type text}, {"AGENT REF#", type text}, {"ACCOM. BOOKING NO.", Int64.Type}, {"LT NO. (OFFICE USE)", Int64.Type}, {"NUMBER OF PEOPLE", Int64.Type}, {"NUMBER OF BAGGAGE", Int64.Type}, {"SKI/SNOWBOARD", Int64.Type}, {"CHILD SEAT OPTION", type text}, {"PICK-UP TIME", type time}, {"FLIGHT DEPART TIME", type time}, {"* NUMBER OF DAYS", type text}, {"* FULL NAME", type text}, {"HEIGHT", type text}, {"WEIGHT", type text}, {"SHOE SIZE", type text}, {"LEVEL (SKIERS ONLY)", type text}, {"* PICK UP LOCATION", type text}, {"* AGE", type text}, {"REQUEST / NOTES", type text}, {"SIZE", type text}, {"AGENT REF #", type text}, {"BEDROOM 1", type text}, {"RESTAURANT", type text}, {"START TIME", type time}, {"END TIME (OPTIONAL)", type time}, {"BOOKING NAME", type text}, {"BOOKING NUMBER (OPT)", type text}, {"PAX", Int64.Type}, {"PICK UP TIME (OPT)", type text}, {"MASTER BEDROOM", type text}, {"BEDROOM 2", type text}, {"TATAMI BEDROOM (3F)", type text}, {"MASTER BEDROOM (2F)", type text}, {"BEDROOM (2F)", type text}, {"STUDY (2F SLIDING DR", type text}, {"MAID ROOM (1F)", type text}, {"FRONT BEDROOM", type text}, {"MIDDLE BEDROOM", type text}, {"FUTON (B1)", type text}, {"2 NIGHTS (¥ 5,000)", Int64.Type}, {"1F MASTER BEDROOM", type text}, {"1F BUNK ROOM", type text}, {"1F GUEST BEDROOM", type text}, {"MASTER BEDROOM (1F)", type text}, {"MASTER BEDROOM (3F)", type text}, {"BEDROOM 3 (1F)", type text}, {"BEDROOM 4 (3F)", type text}, {"1F BEDROOM", type text}, {"2F BEDROOM (LEFT)", type text}, {"2F BEDROOM (RIGHT)", type text}, {"EXPERIENCE LEVEL", type text}, {"LESSON START TIME", type time}, {"CHECK OUT DATE", type text}, {"MEETING DETAILS", type text}, {"MEETING/PICKUP TIME", type text}, {"ACCOM NAME AND ROOM#", type text}, {"NAMES (& AGES)", type text}, {"CONTACT NUMBER", type text}, {"(ADMIN USE)", type time}, {"GUEST NAME", type text}, {"DISCIPLINE", type text}, {"ABILITY LEVELS", type text}, {"MEETING POINT", type text}, {"AGENT REFERENCE", type text}, {"NUMBER OF GUESTS", Int64.Type}, {"LESSON LENGTH", type time}, {"CAR TYPE", type text}, {"NO. OF PASSENGERS", Int64.Type}, {"NO. OF BAGGAGE", type text}, {"BOOSTER SEATS", type text}, {"DROP-OFF LOCATION", type text}, {"REMARKS", type text}, {"NUMBER OF NIGHTS", Int64.Type}, {"LESSON DURATION", type time}, {"PICK-UP LOCATION", type text}, {"FLIGHT DEP. TIME", type time}, {"OPTION", type text}, {"BEDROOM 1 (1F)", type text}, {"BEDROOM 2 (1F)", type text}, {"1F MAID ROOM", type text}, {"1F GUEST ROOM", type text}, {"2F GUEST ROOM", type text}, {"2F TWIN (LEFT)", type text}, {"2F BUNK (RIGHT)", type text}, {"2F BEDROOM 1", type text}, {"2F MASTER GUEST ROOM", type text}, {"3F MASTER BEDROOM", type text}, {"CLASS", type text}, {"DRIVER NAME", type text}, {"PICK UP DATE", type date}, {"PICK UP TIME", type time}, {"RETURN DATE", type date}, {"RETURN TIME", type time}, {"RETURN LOCATION", type text}, {"VENDOR CONFIRMATION", type text}, {"OPTIONS(USECOMMENTS)", type text}, {"ABILITY LEVEL", type text}, {"NAME OF GUEST", type text}, {"AGE CATEGORY", type text}, {"AIRLINE", type text}, {"FLIGHT DEPARTURETIME", type time}, {"FLIGHT NO. WITH CODE", type text}, {"MIDDLE BDRM (ASHLEY)", type text}, {"END BEDROOM (RYAN)", type text}, {"FUTONS", Int64.Type}, {"GUEST ROOM", type text}, {"MAID ROOM", type text}, {"LOUNGE AREA", type text}, {"MASTER BDR (3F)", type text}, {"BEDROOM 2 (2F)", type text}, {"BUNK ROOM 1 (2F)", type text}, {"BUNK ROOM 2 (2F)", type text}, {"BEDROOM 5 (1F)", type text}, {"TERMINAL", type text}, {"MEETING PLACE", type text}, {"MEETING TIME", type text}, {"BEDROOM LEFT-S (1F)", type text}, {"BEDROOM RIGHT-B (1F)", type text}, {"Segment", type text}, {"Arrival Time", type text}, {"Departure Time", type text}, {"Buyer Company : Segment", type text}, {"Allocation In Detail / Instructor Name", type text}, {"Package Finalized", type logical}, {"Package Finalized User", type text}, {"Package Finalized Date (Japan Standard Time)", type datetime}, {"Accommodation Trust Transferred", type logical}, {"Item Trust Transferred", type logical}, {"Transferred to Period", type date}, {"Item Tax Amount", Int64.Type}, {"Package Invoiced Amount Tax", Int64.Type}, {"Package Received Amount Tax", Int64.Type}, {"Guest Name(s)", type text}, {"Guest Additional Name(s)", type text}, {"Guest ID(s)", type text}, {"Guest DOB(s)", type text}, {"Guest Postal Code(s)", type text}, {"Address Details", type text}, {"Guest Gender(s)", type text}, {"Guest Height(s)", type text}, {"Guest Weight(s)", type text}, {"Guest ID Country(s)", type text}, {"Guest Emergency Contact(s)", type text}, {"Discount Code", type text}, {"Web Booking", type logical}, {"No. Items in Booking", Int64.Type}, {"Rate Plan", type text}, {"Daily Breakfasts", Int64.Type}, {"Daily Lunches", Int64.Type}, {"Daily Dinners", Int64.Type}, {"Lead Guest Segment", type text}, {"Alt. Gross", Int64.Type}, {"Alt. Sell", Int64.Type}, {"Alt. Currency", type text}, {"On Hold", type logical}, {"Room Allocation", type text}, {"Adults", Int64.Type}, {"Children", Int64.Type}, {"Infants", Int64.Type}, {"Arriving from Airport", type text}, {"Arrival Flight Number", type text}, {"Arrival Flight Time", type text}, {"Arrival Method", type text}, {"Arrival Notes", type text}, {"Departing from Airport", type text}, {"Departure Flight Number", type text}, {"Departure Flight Time", type text}, {"Departure Method", type text}, {"Departure Notes", type text}, {"32 Digit Booking ID", type text}, {"Vendor Location", type text}, {"Housekeeping Schedule", type text}}, "en")
in
  #"Changed column type"

//RBYTD_Base
let
  Source = SharePoint.Files("https://hokkaidotracks.sharepoint.com/sites/digitaldevelopment", [ApiVersion = 15]),
  #"Filtered rows" = Table.SelectRows(Source, each ([Folder Path] = "https://hokkaidotracks.sharepoint.com/sites/digitaldevelopment/Shared Documents/Dashboard/All RB Raw Data/")),
  Navigation = #"Filtered rows"{[Name = "RoomBoss_YTD.xlsx", #"Folder Path" = "https://hokkaidotracks.sharepoint.com/sites/digitaldevelopment/Shared Documents/Dashboard/All RB Raw Data/"]}[Content],
  #"Imported Excel workbook" = Excel.Workbook(Navigation, null, true),
  #"Navigation 1" = #"Imported Excel workbook"{[Item = "RoomBoss", Kind = "Sheet"]}[Data],
  #"Promoted headers" = Table.PromoteHeaders(#"Navigation 1", [PromoteAllScalars = true]),
  #"Changed column type" = Table.TransformColumnTypes(#"Promoted headers", {{"Package ID", Int64.Type}, {"Booking ID", Int64.Type}, {"Custom ID", type text}, {"Status", type text}, {"Order Type", type text}, {"Created (Japan Standard Time)", type datetime}, {"Modified (Japan Standard Time)", type datetime}, {"Finalized (Japan Standard Time)", type datetime}, {"Cancelled (Japan Standard Time)", type datetime}, {"Vendor Company", type text}, {"Buyer Company", type text}, {"Vendor", type text}, {"Lead Guest ID", type text}, {"Lead Guest Name", type text}, {"Lead Guest Additional Name", type text}, {"Lead Guest Email", type text}, {"Lead Guest Additional Email", type text}, {"Lead Guest Residency", type text}, {"Lead Guest Notes", type text}, {"Lead Guest Language", type text}, {"Lead Guest Gender", type text}, {"Lead Guest Date Of Birth", type date}, {"Lead Guest Height", Int64.Type}, {"Lead Guest Weight", Int64.Type}, {"Lead Guest Telephone", type text}, {"Lead Guest Fax", type text}, {"Lead Guest ZIP/Postal Code", Int64.Type}, {"Lead Guest Address 1", type text}, {"Lead Guest Address 2", type text}, {"Lead Guest City", type text}, {"Lead Guest State/Province/Region", type text}, {"Lead Guest Custom Id", type text}, {"Lead Guest External Id", type text}, {"Lead Guest Passport Number", type text}, {"Lead Guest ID Country", type text}, {"Lead Guest Emergency Contact Name", type text}, {"Lead Guest Emergency Contact Telephone", Int64.Type}, {"Lead Guest Note Dietary", type text}, {"Lead Guest Note Medical", type text}, {"Parent Category", type text}, {"Category", type text}, {"Product ID", type text}, {"Product", type text}, {"Code", type text}, {"Check In / Start", type date}, {"Check Out / End", type date}, {"Nights/Days", Int64.Type}, {"Item Rack Rate", Int64.Type}, {"Item Gross Price", Int64.Type}, {"Item Sell Price", Int64.Type}, {"Item Buy Price", Int64.Type}, {"Package Sell Price", Int64.Type}, {"Package Invoiced Amount", Int64.Type}, {"Difference", Int64.Type}, {"Package Received Amount", Int64.Type}, {"Balance", Int64.Type}, {"Vendor Contact Name", type text}, {"Vendor Contact Email", type text}, {"Agent Contact Name", type text}, {"Agent Contact Email", type text}, {"Message", type text}, {"Comment", type text}, {"Notes", type text}, {"Room/Resource", type text}, {"Option 1", type text}, {"BEDROOM 1", type text}, {"BEDROOM 2", type text}, {"FUTON", type text}, {"BABY COT", type text}, {"ACCOMMODATION NAME", type text}, {"ACCOM PROVIDER NAME", type text}, {"ACCOM. BOOKING NO.", type text}, {"(01) MASTER BEDROOM", type text}, {"(01) BEDROOM 2", type text}, {"(01) BEDROOM 3", type text}, {"(03) MASTER BEDROOM", type text}, {"(03) BEDROOM 2", type text}, {"NUMBER OF DAYS", Int64.Type}, {"NUMBER DAYS HIRE", Int64.Type}, {"ABILITY", type text}, {"VEHICLE", type text}, {"ARRIVAL TERMINAL", type text}, {"ARRIVAL FLIGHT NO.", type text}, {"ARRIVAL FLIGHT TIME", type time}, {"DESTINATION (HOTEL)", type text}, {"NUMBER OF PEOPLE", Int64.Type}, {"NUMBER OF SUITCASES", Int64.Type}, {"SKI BAG OR GOLF BAG", Int64.Type}, {"NOTE", type text}, {"ADDITIONAL SERVICES", type text}, {"DEPARTURE TIME", type text}, {"PICK-UP FROM", type text}, {"DESTINATION", type text}, {"DEPART FLIGHT NO.", type text}, {"DEPART FLIGHT TIME", type time}, {"NAME OF THE VENDOR", type text}, {"TYPE OF CUISINE", type text}, {"START TIME", type time}, {"NUMBER OF ADULTS", Int64.Type}, {"NUMBER OF CHILDREN", Int64.Type}, {"FOOD ALLERGIES", type text}, {"NOTES", type text}, {"MASTER BEDROOM", type text}, {"SPA ROOM", type text}, {"MASTER BEDROOM (2F)", type text}, {"ROOM2 RIGHT STREET", type text}, {"ROOM3 RIGHT CORRIDOR", type text}, {"ROOM4 LEFT CORRIDOR", type text}, {"ROOM5 LEFT STREET", type text}, {"CLASS", type text}, {"DRIVER NAME", type text}, {"PICK UP DATE", type text}, {"PICK UP TIME", type time}, {"PICK UP LOCATION", type text}, {"RETURN DATE", type text}, {"RETURN TIME", type text}, {"RETURN LOCATION", type text}, {"VENDOR CONFIRMATION", Int64.Type}, {"OPTIONS(USECOMMENTS)", type text}, {"COMPANY", type text}, {"TIME", type text}, {"NAME", type text}, {"TOTAL PAX", Int64.Type}, {"FLIGHT", type text}, {"DESTINATION LOCATION", type text}, {"TYPE", type text}, {"VENDOR REFERENCE #", type text}, {"GUEST NAME", type text}, {"PARTICIPANTS", type text}, {"AM/PM", type text}, {"LEVEL", type text}, {"MEETING POINT-HIRAFU", type text}, {"VENDOR NAME", type text}, {"SERVICE MENU", type text}, {"HOW MANY PEOPLE?", Int64.Type}, {"PICK UP REQUIRED?", type text}, {"PHONE NUMBER", type text}, {"NATIONALITIES", type text}, {"ANY FOOD ALLERGIES?", type text}, {"Option 4", type time}, {"LOCATION/LODGING", type text}, {"DO YOU NEED PICK UP？", type text}, {"PICKUP INTERNAL USE", type text}, {"HOW MANY CHILDREN?", type text}, {"GUEST'S PHONE NUMBER", Int64.Type}, {"TOUR LENGTH", type time}, {"THE RENTS", type text}, {"SERAPHINE", type text}, {"AMADEUS", type text}, {"GUINESS", type text}, {"THE BIG EL", type text}, {"CAYMAN'S CORNER", type text}, {"LOCATION", type text}, {"EMAIL", type text}, {"PROGRAM", type text}, {"AGE RANGE", type text}, {"RIDER ABILITY", type text}, {"Accommodation", type text}, {"CONFIRMATION #", type text}, {"DISCIPLINE", type text}, {"EXPERIENCE LEVEL", type text}, {"MEETING/PICK UP TIME", type time}, {"MEETING DETAILS", type text}, {"CONTACT NUMBER", Int64.Type}, {"NOTES/REQUESTS", type text}, {"MAIN GUEST NAME", type text}, {"PICK UP PLACE", type text}, {"DESTINATION RESORT", type text}, {"MEETING TIME", type time}, {"REQUESTS/NOTES", type text}, {"CATEGORY", type text}, {"LANGUAGE", type text}, {"LESSON LEVEL", type text}, {"NAME OF GUEST", Int64.Type}, {"LESSON COURSE", type text}, {"BEGINNER LEVEL", type text}, {"MEETING LOCATION", type text}, {"EMERGENCY CONTACT N.", Int64.Type}, {"AGE OF THE KID", Int64.Type}, {"END TIME", type time}, {"MEETING PICK UP TIME", type text}, {"ABILITY LEVEL", type text}, {"ACCOM & ROOM NUMBER", type text}, {"NAMES & AGES", type text}, {"VENDOR", type text}, {"GUEST NAME/S", type text}, {"GUEST AGE/S", type text}, {"MEETING POINT", type text}, {"LESSON AIMS / GOALS", type text}, {"REQUEST / NOTES", type text}, {"NUMBER OF GUESTS", Int64.Type}, {"LESSON LENGTH", type time}, {"DURATION (HH:MM)", type time}, {"START TIME (24H)", type time}, {"CHILD 1 - NAME & AGE", type text}, {"CHILD 2 - NAME & AGE", type text}, {"AREA", type text}, {"ROOM NUMBER", type text}, {"-", type text}, {"TRANSPORTATION", type text}, {"TIME DURATION", type time}, {"1F MASTER", type text}, {"1F BUNKBED ROOM", type text}, {"2F MASTER", type text}, {"2F GUEST", type text}, {"ARR. FLIGHT NO&TIME", type text}, {"DROP OFF LOCATION", type text}, {"NUMBER OF 6YO & OVER", Int64.Type}, {"NUMBER OF 4-5 YO", Int64.Type}, {"NUMBER OF 1-3 YO", Int64.Type}, {"NUMBER OF 0 YO", Int64.Type}, {"NUMBER OF LUGGAGE", Int64.Type}, {"NUMBER OF SKI&BOARD", type text}, {"BEDROOM RIGHT", type text}, {"BEDROOM LEFT", type text}, {"BEDROOM ENTRANCE", type text}, {"NUMBER OF PACKAGES", Int64.Type}, {"¥1100 FOR DELIVERY", Int64.Type}, {"BUNKBED ROOM", type text}, {"TATAMI ROOM", type text}, {"NUMBER OF NIGHTS", Int64.Type}, {"DESCRIPTION", type text}, {"Segment", type text}, {"Arrival Time", type text}, {"Departure Time", type text}, {"Buyer Company : Segment", type text}, {"Allocation In Detail / Instructor Name", type text}, {"Package Finalized", type logical}, {"Package Finalized User", type text}, {"Package Finalized Date (Japan Standard Time)", type datetime}, {"Accommodation Trust Transferred", type logical}, {"Item Trust Transferred", type logical}, {"Transferred to Period", type date}, {"Item Tax Amount", Int64.Type}, {"Package Invoiced Amount Tax", Int64.Type}, {"Package Received Amount Tax", Int64.Type}, {"Guest Name(s)", type text}, {"Guest Additional Name(s)", type text}, {"Guest ID(s)", type text}, {"Guest DOB(s)", type text}, {"Guest Postal Code(s)", Int64.Type}, {"Address Details", Int64.Type}, {"Guest Gender(s)", type text}, {"Guest Height(s)", type text}, {"Guest Weight(s)", type text}, {"Guest ID Country(s)", type text}, {"Guest Emergency Contact(s)", type text}, {"Applied Adjustments", type text}, {"Discount Code", type text}, {"Taxable Amount", Int64.Type}, {"Sales tax", Int64.Type}, {"Local Tax", Int64.Type}, {"Sales Tax", Int64.Type}, {"Initial Order Type", type text}, {"Widget URL", type text}, {"Web Booking", type logical}, {"No. Items in Booking", Int64.Type}, {"Rate Plan", type text}, {"Daily Breakfasts", Int64.Type}, {"Daily Lunches", Int64.Type}, {"Daily Dinners", Int64.Type}, {"Alt. Gross", Int64.Type}, {"Alt. Sell", Int64.Type}, {"Alt. Currency", type text}, {"On Hold", type logical}, {"Room Allocation", type text}, {"Adults", Int64.Type}, {"Children", Int64.Type}, {"Infants", Int64.Type}, {"Arriving from Airport", type text}, {"Arrival Flight Number", type text}, {"Arrival Flight Time", type text}, {"Arrival Method", type text}, {"Arrival Notes", type text}, {"Departing from Airport", type text}, {"Departure Flight Number", type text}, {"Departure Flight Time", type text}, {"Departure Method", type text}, {"Departure Notes", type text}, {"32 Digit Booking ID", type text}, {"Vendor Location", type text}, {"Housekeeping Schedule", type text}}, "en")
in
  #"Changed column type"

//MasterColumns
let
    // Superset of all column names across both tables
    MasterColumns =
        List.Union({
            Table.ColumnNames(RBYTD_Base),
            Table.ColumnNames(RBHist_Base)
        }),
  #"Removed duplicates" = List.Distinct(MasterColumns)
in
    #"Removed duplicates"

//RB2025_Align
let
  Source = RBYTD_Base,
  #"Align to Superset" =
    Table.SelectColumns(
        Source,  
        MasterColumns,
        MissingField.UseNull)

in
  #"Align to Superset"

//RBHist_Align *export to Lakehouse; replace w/ dynamic schema
let
  Source = RBHist_Base,
  #"Align to Superset" =
    Table.SelectColumns(
        Source,   // or whatever the last step is called
        MasterColumns,
        MissingField.UseNull   // pad missing columns with null
    ),
  #"Appended query" = Table.Combine({#"Align to Superset", RB2025_Align}),
  #"Changed column type" = Table.TransformColumnTypes(#"Appended query", {{"VENDOR NAME", type text}, {"SERVICE MENU", type text}}),
  #"Renamed columns" = Table.RenameColumns(#"Changed column type", {{"Created (Japan Standard Time)", "Created"}, {"Modified (Japan Standard Time)", "Modified"}, {"Finalized (Japan Standard Time)", "Finalized"}, {"Cancelled (Japan Standard Time)", "Cancelled"}}),
  #"Changed column type 1" = Table.TransformColumnTypes(#"Renamed columns", {{"Option 1", type text}}),
  Custom = Table.TransformColumnTypes(#"Changed column type 1", {{"DESCRIPTION", type text}}, "en-US"),
  #"Custom 1" = Table.TransformColumns(
        #"Custom",
        {{"DESCRIPTION", each Text.From(_), type text}}
    )
in
  #"Custom 1"

